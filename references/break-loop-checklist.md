# 卡住时的破局清单（Break-loop Checklist）

目标：当连续失败/排查空转时，把“下一次尝试”变成高信息增益的行动，而不是重复试错。

触发（任一即算）：
- `CONSECUTIVE_FAILURES >= 3`
- 同一错误在 2 次以上复现但原因不明
- 工具调用密集但进展不明显（例如 >10 次仍无实质推进）或会话可能中断

---

## 1) 先定性失败类型（选 1 个主因）

- **A. 规格/上下文缺失**：缺成功标准/边界/约束/接口契约，导致无法判断“做对了没”
- **B. 环境/依赖阻断**：安装/权限/系统依赖/网络/版本不匹配
- **C. 代码事实冲突**：现有实现与方案假设冲突，或存在隐藏耦合/副作用
- **D. 工具/命令误用**：命令矩阵不清、目录不对、Shell/编码问题
- **E. 风险/合规红线**：EHRB 触发导致必须降速/确认或改路径

---

## 2) 立即执行的 5 步（最多 1 轮）

1. **复现**：写出最小复现命令/步骤 + 预期/实际（`[SRC:TOOL]`）
2. **证据**：截取最关键的 3–5 行错误摘要（不要整屏）
3. **假设**：列出 ≤3 个最可能原因（`[SRC:INFER]`），并给出对应验证动作
4. **收敛**：提出 2–3 个可选决策（补信息/换路径/收敛范围/终止）
5. **落盘**：写入 `task.md##上下文快照`（事实/推断分区 + 来源标签）

---

## 3) 输出给用户的最小信息包

- 失败点 + 错误摘要（1–3 行）
- 已尝试修复（1–2 条）
- 缺失信息清单（若有）
- 2–3 个可选决策（下一步）

参考：`references/failure-protocol.md` 的交互模板。

