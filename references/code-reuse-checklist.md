# 复用与去重检查清单（Code Reuse Thinking）

目标：减少重复与耦合；优先复用已有能力；避免 `utils/` 膨胀与跨层反向依赖。

触发：见 `references/checklist-triggers.md`。

---

## Checklist

- **搜索先行**：在新增任何函数/模块前，先 `rg` 搜关键名词/字段名/错误码/相似函数；至少找到 1 个参考实现再决定新增
- **抽象门禁**：只有在“重复≥2处且预计增长”且“不引入反向依赖/跨层依赖”时才抽公共模块
- **边界优先**：抽象必须能用领域名词命名；避免 `utils/common/helpers` 成垃圾场
- **局部优先**：若复用会引入跨层依赖，宁可局部复制并保持边界清晰
- **新增公共工具需记录**：在 `how.md##复用与去重策略` 写清“复用点/边界/为何不是局部实现”
- **入口收敛**：同类能力散落多处时，优先收敛到单一公共入口（public surface），再扩散调用

---

## 常见反模式（命中即停下来想一遍）

- 为了复用把领域逻辑塞进“无语义 util”
- 抽象层反向依赖业务模块，形成依赖环
- 多模块互相 import 内部文件，导致隐藏耦合与循环依赖风险

